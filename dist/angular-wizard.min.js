/**
 * Easy to use Wizard library for AngularJS
 * @version v0.4.2 - 2015-03-27 * @link https://github.com/mgonto/angular-wizard
 * @author Martin Gontovnikas <martin@gon.to>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
function wizardButtonDirective(a){angular.module("mgo-angular-wizard").directive(a,function(){return{restrict:"A",replace:!1,require:"^wizard",link:function(b,c,d,e){c.on("click",function(c){c.preventDefault(),b.$apply(function(){b.$eval(d[a]),e[a.replace("wz","").toLowerCase()]()})})}}})}angular.module("templates-angularwizard",["step.html","wizard.html"]),angular.module("step.html",[]).run(["$templateCache",function(a){a.put("step.html",'<section ng-show="selected" ng-class="{current: selected, done: completed}" class="step" ng-transclude>\n</section>')}]),angular.module("wizard.html",[]).run(["$templateCache",function(a){a.put("wizard.html",'<div>\n    <div class="steps" ng-transclude></div>\n    <ul class="steps-indicator steps-{{steps.length}}" ng-if="!hideIndicators">\n      <li ng-class="{default: !step.completed && !step.selected, current: step.selected && !step.completed, done: step.completed && !step.selected, editing: step.selected && step.completed}" ng-repeat="step in steps | filter: step">\n        <a ng-click="goTo(step)">{{step.title || step.wzTitle}}</a>\n      </li>\n    </ul>\n</div>\n')}]),angular.module("mgo-angular-wizard",["templates-angularwizard"]),angular.module("mgo-angular-wizard").directive("wzStep",["$rootScope",function(a){return{restrict:"EA",replace:!0,transclude:!0,scope:{wzTitle:"@",title:"@",canenter:"=",canexit:"=",orderIndex:"@"},require:"^wizard",templateUrl:function(a,b){return b.template||"step.html"},link:function(b,c,d,e){b.title=b.title||b.wzTitle,e.transcluded?e.addStep(b):a.$on("mgo-angular-wizard.transcluded",function(a,c){e.name==c&&e.addStep(b)})}}}]),angular.module("mgo-angular-wizard").directive("wizard",["$rootScope",function(a){return{restrict:"EA",replace:!0,transclude:!0,scope:{currentStep:"=",onFinish:"&",hideIndicators:"=",editMode:"=",name:"@"},templateUrl:function(a,b){return b.template||"wizard.html"},link:function(b,c){var d=function(a){for(var b=[],c=a[0].getElementsByTagName("*"),d=0,e=c.length;e>d;d++){var f=c[d],g=angular.element(f);(!_.isUndefined(g.attr("wz-step"))||"wz-step"==f.nodeName.toLowerCase()||g.hasClass("step"))&&b.push(g.attr("title")||g.attr("wz-title"))}return b};b.steps_ordering=d(c),b.steps_count=b.steps_ordering.length,b.steps=new Array(b.steps_count),b.transcluded=!0,a.$broadcast("mgo-angular-wizard.transcluded",b.name)},controller:["$scope","$element","$log","WizardHandler",function(a,b,c,d){function e(){_.each(a.steps,function(a){a&&(a.selected=!1)}),a.selectedStep=null}var f=!0;this.name=a.name||d.defaultName,a.name=this.name,d.addWizard(this.name,this),a.$on("$destroy",function(){d.removeWizard(a.name||d.defaultName)}),this.transcluded=a.transcluded||!1;var g=this;a.$watch("transcluded",function(a){a&&(g.transcluded=!0)}),a.context={},a.$watch("currentStep",function(b){if(b&&!_.isUndefined(a.selectedStep)){var c=a.selectedStep.title||a.selectedStep.wzTitle;c!==a.currentStep&&a.goTo(_.findWhere(a.steps,{title:a.currentStep}))}}),a.$watch("[editMode, steps.length]",function(){var b=a.editMode;_.isUndefined(b)||_.isNull(b)||b&&_.each(a.steps,function(a){_.isUndefined(a)||(a.completed=!0)})},!0),this.addStep=function(b){b.selected=!1;var c;c=_.isUndefined(b.orderIndex)?_.indexOf(a.steps_ordering,b.title):b.orderIndex,a.steps[c]=b,0===c&&a.goTo(a.steps[0])},this.context=a.context,a.getStepNumber=function(b){return _.indexOf(a.steps,b)+1},a.goTo=function(b){if(f)e(),a.selectedStep=b,_.isUndefined(a.currentStep)||(a.currentStep=b.title||b.wzTitle),b.selected=!0,a.$emit("wizard:stepChanged",{step:b,index:_.indexOf(a.steps,b)}),f=!1;else{var c,d=!1,g=!1;if(a.currentStepNumber()>0?c=a.currentStepNumber()-1:0===a.currentStepNumber()&&(c=0),("undefined"==typeof a.steps[c].canexit||a.steps[c].canexit(a.context)===!0)&&(d=!0),a.getStepNumber(b)<a.currentStepNumber()&&(d=!0),(d&&void 0===b.canenter||d&&b.canenter(a.context)===!0)&&(g=!0),!d||!g)return;e(),a.selectedStep=b,_.isUndefined(a.currentStep)||(a.currentStep=b.title||b.wzTitle),b.selected=!0,a.$emit("wizard:stepChanged",{step:b,index:_.indexOf(a.steps,b)})}},a.currentStepNumber=function(){return _.indexOf(a.steps,a.selectedStep)+1},this.currentStepNumber=function(){return a.currentStepNumber()},this.next=function(b){var c=_.indexOf(a.steps,a.selectedStep);if(angular.isFunction(b)){if(!b())return;c===a.steps.length-1?this.finish():a.goTo(a.steps[c+1])}b||(a.selectedStep.completed=!0),c===a.steps.length-1?this.finish():a.goTo(a.steps[c+1])},this.goTo=function(b){var c;c=_.isNumber(b)?a.steps[b]:_.findWhere(a.steps,{title:b}),a.goTo(c)},this.finish=function(){a.onFinish&&a.onFinish()},this.cancel=this.previous=function(){var b=_.indexOf(a.steps,a.selectedStep);if(0===b)throw new Error("Can't go back. It's already in step 0");a.goTo(a.steps[b-1])}}]}}]),wizardButtonDirective("wzNext"),wizardButtonDirective("wzPrevious"),wizardButtonDirective("wzFinish"),wizardButtonDirective("wzCancel"),angular.module("mgo-angular-wizard").factory("WizardHandler",function(){var a={},b={};return a.defaultName="defaultWizard",a.addWizard=function(a,c){b[a]=c},a.removeWizard=function(a){delete b[a]},a.wizard=function(c){var d=c;return c||(d=a.defaultName),b[d]},a});